# Traefik main configuration for simplified deployment
# Following team guidelines for directory structure

entryPoints:
  web:
    address: ":{{ traefik_web_port }}"
  websecure:
    address: ":{{ traefik_websecure_port }}"

providers:
  docker:
    endpoint: "unix://{{ traefik_docker_socket }}"
    exposedByDefault: false
  file:
    directory: "{{ traefik_container_dynamic_path }}"
    watch: true

api:
  dashboard: {{ traefik_dashboard_enabled | lower }}
  insecure: false

certificatesResolvers:
  letsencrypt:
    acme:
      email: "{{ traefik_acme_email }}"
      storage: "{{ traefik_acme_storage }}"
{% if traefik_acme_staging %}
      caServer: "https://acme-staging-v02.api.letsencrypt.org/directory"
{% endif %}
      httpChallenge:
        entryPoint: web

log:
  level: {{ traefik_log_level }}
  filePath: "{{ traefik_container_logs_path }}/traefik.log"

accessLog:
  filePath: "{{ traefik_container_logs_path }}/access.log"
